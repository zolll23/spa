# Сервис комментирования поста

# Описание

Сервис добавления комментариев к посту. Выводит некий пост и форму комментирования под ним, при добавлении комментария 
происходит валидация средствами HTML5 на фронте, и средствами PHP на бекенде. В текущей реализации валидация оформлена 
как сервис, который вызывается перед вызовом добавления записи через сервис репозитория, но при полноценной реализации 
DDD и добавлении ValueObject-ов, описывающих свойства сущности комментария, валидацию можно перенести в нее.

Под формой ввода комментария выводится список всех комментариев, добавленных пользователями ранее, комментарии выводятся
по убыванию даты добавления (новые вначале). Выводится дата добавления комментария, заголовок, содержание, никнейм автора,
который обрамлен ссылкой на почтовый ящик электронной почты автора (mailto).

Обновление списка комментариев происходит ассинхронно сразу после добавления
нового комментария, при этом происходит загрузка всех комментариев с сервера, для того, чтобы показывать клиенту не
только комментарий, который добавил он, но и загрузить комментарии, которые могли оставить другие пользователи.

Получение данных происходит через axios, но при желании можно использовать Swagger для описания API и 
сгенерировать SDK с помощью openapi-generator-cli для получения более стандартизованного механизма взаимодействия с
бекендом.


Точка входа в бекенд-сервис: backend/src/index.php. На бекенде из стороннего кода используются только библиотеки, 
реализующие PSR-7 & PSR-15 для работы с Request & Response.

Для реализации PSR-11 используется ранее написаная библиотека https://github.com/zolll23/DI 

Весь код, реализующий архитектуру фреймворка (Модуль приложения, роутер, работа с БД и валидация) находятсв каталоге
*backend/src/VPA*

Вся логика приложения - *backend/src/Spa* 



# Разворачивание

**Порядок действий для развертывания приложения**:
- Добавить в */etc/hosts* следующие адреса: *spa.local api.spa.local*
- По умолчанию порт nginx 3180, если надо изменить, то в .env переменная SPA_NGINX_PORT, остальные переменные изменить соответственно
- Добавить все необходимые параметры в *.env*
- make init-docker

**Backend**:
- *make init-back*
- Результатом должны быть успешно выполненные тесты
- *make git-install-hooks* - для CodeSniffer

**Frontend**:
- *make init-front*
- По ссылке *http://spa.local:3180/* должна открыться страница 

**Обновление базы данных**
- make init-main-db

# Использование
- *http://spa.local:3180/* - клиентская часть приложения
- *http://api.spa.local:3180/* - доступ к API
- У API есть 2 эндпоинта:
- GET http://spa.local:3180/api/v1/post/comments - для получения списка комментариев
- POST http://spa.local:3180/api/v1/post/comment/add - для добавления комментария